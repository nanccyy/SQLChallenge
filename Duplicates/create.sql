create table events(
    device_id text not null,
    connected_at timestamp not null,
    disconnected_at timestamp null,
    unique(device_id, connected_at),
    CONSTRAINT time_check CHECK (connected_at <= disconnected_at)
);

insert into
    events (device_id, connected_at, disconnected_at)
values
    (
        'c4ca4238a0b923820dcc509a6f75849b',
        '2022-11-12 20:05',
        null
    ),
    (
        'c4ca4238a0b923820dcc509a6f75849b',
        '2022-11-12 23:05',
        '2022-11-13 10:05'
    ),
    (
        'c4ca4238a0b923820dcc509a6f75849b',
        '2022-11-13 10:05',
        '2022-11-13 14:05'
    ),
    (
        'c4ca4238a0b923820dcc509a6f75849b',
        '2022-11-13 14:05',
        '2022-11-13 20:00'
    ),
    (
        'c4ca4238a0b923820dcc509a6f75849b',
        '2022-11-13 20:00',
        null
    ),
    (
        'c4ca4238a0b923820dcc509a6f75849b',
        '2022-11-14 23:05',
        '2022-11-14 23:45'
    ),
    (
        'c4ca4238a0b923820dcc509a6f75849b',
        '2022-11-14 23:50',
        null
    ),
    (
        'c4ca4238a0b923820dcc509a6f75849b',
        '2022-11-15 07:50',
        '2022-11-15 20:00'
    ),
    (
        'c4ca4238a0b923820dcc509a6f75849b',
        '2022-11-15 20:05',
        '2022-11-15 22:00'
    ),
    (
        'c4ca4238a0b923820dcc509a6f75849b',
        '2022-11-15 22:06',
        '2022-11-15 23:05'
    ),
    (
        'c4ca4238a0b923820dcc509a6f75849b',
        '2022-11-15 23:05',
        null
    ),
    (
        'c81e728d9d4c2f636f067f89cc14862c',
        '2022-11-12 20:05',
        '2022-11-12 23:05'
    ),
    (
        'c81e728d9d4c2f636f067f89cc14862c',
        '2022-11-12 23:05',
        '2022-11-13 10:05'
    ),
    (
        'c81e728d9d4c2f636f067f89cc14862c',
        '2022-11-13 10:05',
        '2022-11-13 14:05'
    ),
    (
        'c81e728d9d4c2f636f067f89cc14862c',
        '2022-11-13 14:05',
        '2022-11-13 20:00'
    ),
    (
        'c81e728d9d4c2f636f067f89cc14862c',
        '2022-11-13 20:00',
        '2022-11-14 23:05'
    ),
    (
        'c81e728d9d4c2f636f067f89cc14862c',
        '2022-11-14 23:05',
        '2022-11-14 23:45'
    ),
    (
        'c81e728d9d4c2f636f067f89cc14862c',
        '2022-11-14 23:50',
        null
    ),
    (
        'c81e728d9d4c2f636f067f89cc14862c',
        '2022-11-15 07:50',
        '2022-11-15 20:00'
    ),
    (
        'c81e728d9d4c2f636f067f89cc14862c',
        '2022-11-15 20:05',
        '2022-11-15 22:00'
    ),
    (
        'c81e728d9d4c2f636f067f89cc14862c',
        '2022-11-15 22:06',
        null
    ),
    (
        'c81e728d9d4c2f636f067f89cc14862c',
        '2022-11-15 23:05',
        null
    )